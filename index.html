<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ã“ptica Jaziel - PRO</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
body{font-family:Inter,Arial;margin:0;background:#f7fbfc;color:#072021}
.container{max-width:1100px;margin:28px auto;padding:20px}
header{display:flex;justify-content:space-between;align-items:center}
.logo-wrap img{width:84px;height:84px}
nav a{margin-left:16px;color:#6b7280;text-decoration:none}
.hero{display:flex;gap:20px;align-items:center;margin-top:20px}
.hero-right img{width:100%;height:320px;object-fit:cover;border-radius:12px}
.products{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px;margin-top:18px}
.card{background:#fff;border-radius:10px;overflow:hidden;padding-bottom:12px;border:1px solid #eaf6f6}
.card img{width:100%;height:160px;object-fit:cover}
.form input{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #e9f2f2}
.button{padding:10px 12px;background:#007b8f;color:#fff;border:0;border-radius:8px;cursor:pointer;margin-top:8px}
.chat-bubble{position:fixed;right:20px;bottom:20px;width:64px;height:64px;border-radius:50%;background:linear-gradient(135deg,#00b4c7,#007b8f);display:flex;align-items:center;justify-content:center;color:#fff;cursor:pointer}
.chat-panel{position:fixed;right:20px;bottom:100px;width:420px;height:600px;background:#fff;display:none}
</style>
</head>
<body>
<div class="container">
  <header>
    <div class="brand">
      <div class="logo-wrap"><img src="assets/logo.svg" alt="logo"></div>
      <div><strong>Ã“ptica Jaziel</strong><div style="color:#6b7280">Cuidamos tu visiÃ³n con estilo</div></div>
    </div>
    <nav><a href="#productos">Productos</a><a href="#servicios">Servicios</a><a href="#contacto">Contacto</a></nav>
  </header>

  <section class="hero">
    <div class="hero-left" style="flex:1">
      <h1>Tu visiÃ³n, nuestro compromiso</h1>
      <p style="color:#6b7280">Medidas y servicios en Av. Guillermo de la Fuente NÂ°475 - Comas</p>
      <button class="button" onclick="document.getElementById('productos').scrollIntoView()">Ver catÃ¡logo</button>
    </div>
    <div class="hero-right" style="width:460px"><img src="https://images.unsplash.com/photo-1588774069165-8d8a6b8a6d1d?auto=format&fit=crop&w=1400&q=60" alt="Persona con lentes"></div>
  </section>

  <h2 id="productos">Productos destacados</h2>
  <div class="products" id="productList"></div>

  <h2 id="servicios">Servicios</h2>
  <div class="services">
    <div class="service" style="background:#fff;padding:12px;border-radius:10px">Examen visual profesional</div>
    <div class="service" style="background:#fff;padding:12px;border-radius:10px">AdaptaciÃ³n de lentes</div>
    <div class="service" style="background:#fff;padding:12px;border-radius:10px">ReparaciÃ³n y ajuste</div>
  </div>

  <section id="contacto">
    <h2>Solicita tu cita</h2>
    <div class="form" style="background:#fff;padding:12px;border-radius:10px">
      <input id="fname" placeholder="Nombre">
      <input id="lname" placeholder="Apellido">
      <input id="dni" placeholder="DNI">
      <input id="phone" placeholder="TelÃ©fono">
      <input id="email" placeholder="Correo">
      <input id="datetime" type="datetime-local">
      <input id="notes" placeholder="Notas">
      <button id="submitAppointment" class="button">Solicitar cita</button>
      <div id="apptMsg" style="display:none;color:green;margin-top:8px">Cita solicitada correctamente</div>
    </div>
  </section>

  <footer style="margin-top:20px;color:#6b7280">Â© Ã“ptica Jaziel â€¢ Av. Guillermo de la Fuente NÂ°475 - Comas</footer>
</div>

<div class="chat-bubble" id="chatBubble">ðŸ’¬</div>
<div class="chat-panel" id="chatPanel"><iframe src="https://studio.botpress.cloud/ab471b82-6e16-4dae-b824-fb200d6b3338/flows/wf-main" style="width:100%;height:100%;border:0"></iframe></div>

<script>
const DB = {"info": {"name": "\u00d3ptica Jaziel", "address": "Av. Guillermo de la Fuente N\u00b0475 - Comas", "whatsapp": "+51997424072", "horarios": "Lun-Sab 9:30 - 19:00"}, "products": [{"id": 1, "category": "Tratamiento", "name": "Lentes Blue Defense", "price": 120, "img": "https://images.unsplash.com/photo-1515876305429-24181f2ff0f6?auto=format&fit=crop&w=800&q=60"}, {"id": 2, "category": "Monturas", "name": "Montura Acetato", "price": 140, "img": "https://images.unsplash.com/photo-1519098901909-b1553a8e9b75?auto=format&fit=crop&w=800&q=60"}, {"id": 3, "category": "Accesorios", "name": "Lentes de Sol Polarizados", "price": 180, "img": "https://images.unsplash.com/photo-1545239351-1141bd82e8a6?auto=format&fit=crop&w=800&q=60"}]};

// render products
(function renderProducts(){const container=document.getElementById('productList');DB.products.forEach((p,i)=>{const c=document.createElement('div');c.className='card';c.innerHTML=`<img src="${p.img}" alt="${p.name}"><div style="padding:10px"><h3 style="margin:6px 0">${p.name}</h3><div style="color:#6b7280">${p.category}</div><div style="color:#007b8f;font-weight:700;margin-top:8px">S/ ${p.price}.00</div></div>`;container.appendChild(c);setTimeout(()=>c.classList.add('visible'),120*i);});})();

document.getElementById('chatBubble').addEventListener('click',()=>document.getElementById('chatPanel').style.display='block');

// appointment submit to Supabase
async function submitAppointment(){
  const fname=document.getElementById('fname').value.trim();
  const lname=document.getElementById('lname').value.trim();
  const dni=document.getElementById('dni').value.trim();
  const phone=document.getElementById('phone').value.trim();
  const email=document.getElementById('email').value.trim();
  const datetime=document.getElementById('datetime').value;
  const notes=document.getElementById('notes').value.trim();
  if(!fname||!lname||!dni||!phone||!email||!datetime){alert('Completa los campos');return;}
  const SUPABASE_URL = window.SUPABASE_URL || '%SUPABASE_URL%';
  const SUPABASE_ANON_KEY = window.SUPABASE_ANON_KEY || '%SUPABASE_ANON_KEY%';
  if(SUPABASE_URL.includes('%')||SUPABASE_ANON_KEY.includes('%')){alert('Supabase no configurado');return;}
  const payload={fname,lname,dni,phone,email,datetime,notes};
  try{
    const res = await fetch(`${SUPABASE_URL}/rest/v1/appointments`,{
      method:'POST',
      headers:{'apikey':SUPABASE_ANON_KEY,'Authorization':'Bearer '+SUPABASE_ANON_KEY,'Content-Type':'application/json','Prefer':'return=representation'},
      body:JSON.stringify(payload)
    });
    if(res.ok){document.getElementById('apptMsg').style.display='block';document.getElementById('fname').value='';document.getElementById('lname').value='';document.getElementById('dni').value='';document.getElementById('phone').value='';document.getElementById('email').value='';document.getElementById('datetime').value='';document.getElementById('notes').value='';}
    else{const t=await res.text();alert('Error: '+t);}
  }catch(e){alert('Error de red: '+e.message);}
}

document.getElementById('submitAppointment').addEventListener('click',submitAppointment);
</script>
</body>
</html>
